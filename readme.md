# ML Pipeline: Breast Cancer Classification

–î–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: [http://91.200.12.9:8080](http://91.200.12.9:8080). –õ–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ –æ—Ç–≤–µ—Ç–µ –Ω–∞ –∑–∞–¥–∞–Ω–∏–µ.


## –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ ML-–ø–∞–π–ø–ª–∞–π–Ω–∞ –≤ Apache Airflow –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≤—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞: –∑–∞–≥—Ä—É–∑–∫–∞, –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞, –æ–±—É—á–µ–Ω–∏–µ, –æ—Ü–µ–Ω–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø–æ –∑–∞–¥–∞—á–µ –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–∞–∫–∞ –≥—Ä—É–¥–∏ (Breast Cancer Wisconsin Diagnostic).

–†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω–æ —Å—Ç–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–ø—É—Ö–æ–ª—å –∑–ª–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∏–ª–∏ –¥–æ–±—Ä–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–±–æ—Ä–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

![–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏](images/screenshot-1.png)

---

##  –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–∏

| üìä –ú–µ—Ç—Ä–∏–∫–∞     | –ó–Ω–∞—á–µ–Ω–∏–µ   |
|-------------|------------|
| Accuracy    | 0.9580     |
| Precision   | 0.9615     |
| Recall      | 0.9259     |
| F1-score    | 0.9434     |


---

## Mermaid –°—Ö–µ–º–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞

```mermaid
graph TD
    A[Load Data] --> B[Preprocess]
    B --> C[Train Model]
    C --> D[Evaluate Model]
    D --> E[Save Results]
```

---

## –û–ø–∏—Å–∞–Ω–∏–µ —à–∞–≥–æ–≤

1. **load\_data.py**: –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç breast cancer –∏–∑ `sklearn.datasets` –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ XCom;
2. **preprocess.py**: —Ä–∞–∑–±–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ X/y, –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∏ —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ XCom;
3. **train\_model.py**: –æ–±—É—á–∞–µ—Ç `RandomForestClassifier`, —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç –º–æ–¥–µ–ª—å –≤ `joblib`, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `/opt/airflow/results/model.pkl`;
4. **evaluate.py**: –≤—ã—á–∏—Å–ª—è–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ (`accuracy`, `f1`, `precision`, `recall`), —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `metrics.json`;
5. **save\_results.py**: –∫–æ–ø–∏—Ä—É–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã `final_model.pkl`, `final_metrics.json`.

---

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker –∏ docker-compose.
2. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone https://github.com/lexgp/airflow.git
   cd airflow
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:
   ```bash
   docker compose up -d --build
   ```
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Airflow ([http://localhost:8080](http://localhost:8080)) –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ DAG `ml_pipeline` –≤—Ä—É—á–Ω—É—é.

---

## –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

- –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:
  - `/opt/airflow/results/model.pkl`
  - `/opt/airflow/results/final_metrics.json`
  - `/opt/airflow/results/final_model.pkl`

–û–Ω–∏ –ø–æ–º–µ—â–µ–Ω—ã –≤ –ø–∞–ø–∫—É [result_dump](result_dump/) –¥–∞–Ω–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.

---

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ:

- ENV-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ .env, –æ–±—Ä–∞–∑–µ—Ü –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –≤ .env.example
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–∞–∂–¥–æ–º –º–æ–¥—É–ª–µ

**Docker** –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å Airflow —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π.

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Airflow

- DAG `ml_pipeline` –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ `dags/pipeline_dag.py`
- –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ `etl/`
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `PythonOperator` —Å –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `XCom`

### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –≤ DAG:

```python
load_task = PythonOperator(
    task_id="load_data",
    python_callable=step_1_load,
    retries=2,
    retry_delay=timedelta(minutes=1),
)
```

---

## –ò–¥–µ–∏ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è

- –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ API –∏–ª–∏ –æ–±–ª–∞—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞–ª–µ—Ä—Ç–æ–≤ (Slack, Telegram) –ø—Ä–∏ —Å–±–æ—è—Ö DAG

---

## –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ —Å–±–æ—è

- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (RAM)
- –ó–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –¥–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
- –ü–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–µ –∏–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, NaN, –Ω–µ–≤–µ—Ä–Ω–∞—è —Ñ–æ—Ä–º–∞ –º–∞—Å—Å–∏–≤–æ–≤, –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã.
- –ü—Ä–æ–±–ª–µ–º—ã —Å XCom (–ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞, –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–∫—Ç—ã) ‚Äî –ø–µ—Ä–µ–¥–∞—á–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ XCom –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—É—Å—Ç–æ–π—á–∏–≤–æ–π.
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –í–ú –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è DAG ‚Äî –ø–æ—Ç–µ—Ä—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, —Ñ–∞–π–ª–æ–≤ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
- –î–æ–ª–≥–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —à–∞–≥–æ–≤ ‚Üí —Ç–∞–π–º–∞—É—Ç—ã Airflow ‚Äî –µ—Å–ª–∏ —à–∞–≥–∏ –Ω–µ —É–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –≤ execution_timeout.

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```
.
‚îú‚îÄ‚îÄ dags/
‚îÇ   ‚îî‚îÄ‚îÄ pipeline_dag.py
‚îú‚îÄ‚îÄ etl/
‚îÇ   ‚îú‚îÄ‚îÄ load_data.py
‚îÇ   ‚îú‚îÄ‚îÄ preprocess.py
‚îÇ   ‚îú‚îÄ‚îÄ train_model.py
‚îÇ   ‚îú‚îÄ‚îÄ evaluate.py
‚îÇ   ‚îî‚îÄ‚îÄ save_results.py
‚îú‚îÄ‚îÄ results/
‚îÇ   ‚îî‚îÄ‚îÄ (–ø–æ—è–≤–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞)
‚îú‚îÄ‚îÄ result_dump/
‚îÇ   ‚îî‚îÄ‚îÄ final_metrics.json
‚îÇ   ‚îî‚îÄ‚îÄ final_model.pkl
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ .env
‚îî‚îÄ‚îÄ README.md
```
